(window.webpackJsonpunifiNetworkUi=window.webpackJsonpunifiNetworkUi||[]).push([[44],{1811:function(e,t,a){"use strict";a.r(t);var l,r,E=a(0),_=a.n(E),n=a(2),c=a(8),o=a(36),i=a(215),T=a(1972),R=a(524),s=a(34),u=a(18),A=a(83),N=a(1938),m=a(663),p=a(27),S=a(70),d=a(16),L=a(105),I=a(30),O=a(2163);!function(e){e.AFTER="AFTER",e.BEFORE="BEFORE"}(l||(l={})),function(e){e.ADDRESS_PORT_GROUP="addressPortGroup",e.IP_ADDRESS="ipAddress",e.NETWORK="network"}(r||(r={}));const F=(e,t,a)=>[{label:a.formatMessage({id:"COMMON_ANY"}),value:""},...e.filter(({group_type:e})=>e===t).map(({_id:e,name:t,group_members:a})=>({label:t,value:e,members:a}))],G=(e,t)=>{const a=e["src"===t?"src_address":"dst_address"],l=e["src"===t?"src_firewallgroup_ids":"dst_firewallgroup_ids"],E=e["src"===t?"src_networkconf_id":"dst_networkconf_id"],_=e["src"===t?"src_networkconf_type":"dst_networkconf_type"];return(null==l?void 0:l.length)>0?r.ADDRESS_PORT_GROUP:a?r.IP_ADDRESS:E||_&&_!==R.FirewallRuleNetworkconfType.NETV4?r.NETWORK:r.ADDRESS_PORT_GROUP},M=e=>Object.values(R.FirewallRuleRulesetV6).includes(e.ruleset),b=(e,t,a)=>{const r={ruleset:R.FirewallRuleRulesetV4.WAN_IN,protocol:"all",protocol_v6:"all",...a},E=M(r)?r.protocol_v6:r.protocol,_=Number.isNaN(Number(E))?{firewallRuleProtocolNumber:0}:{firewallRuleProtocolNumber:Number(E),[M(r)?"protocol_v6":"protocol"]:"number"},n=((e,t,a)=>["dst","src"].reduce((l,r)=>{var E,_;const n=e["src"===r?"src_firewallgroup_ids":"dst_firewallgroup_ids"],c=e["src"===r?"src_networkconf_id":"dst_networkconf_id"];return{...l,["src"===r?"src_networkconf_id":"dst_networkconf_id"]:(null===(E=t.find(({_id:e})=>e===c))||void 0===E?void 0:E._id)||(null===(_=t[0])||void 0===_?void 0:_._id)||"",["src"===r?"firewallRuleSrcIpV4AddressGroup":"firewallRuleDstIpV4AddressGroup"]:n.find(e=>a.some(({_id:t,group_type:a})=>t===e&&a===T.FirewallGroupType.ADDRESS_GROUP))||"",["src"===r?"firewallRuleSrcIpV6AddressGroup":"firewallRuleDstIpV6AddressGroup"]:n.find(e=>a.some(({_id:t,group_type:a})=>t===e&&a===T.FirewallGroupType.IPV6_ADDRESS_GROUP))||"",["src"===r?"firewallRuleSrcPortGroup":"firewallRuleDstPortGroup"]:n.find(e=>a.some(({_id:t,group_type:a})=>t===e&&a===T.FirewallGroupType.PORT_GROUP))||"",["src"===r?"firewallRuleSrcType":"firewallRuleDstType"]:G(e,r)}},{}))({dst_firewallgroup_ids:[],dst_networkconf_id:"",src_firewallgroup_ids:[],src_networkconf_id:"",...a},e,t);return{action:R.FirewallRuleAction.ACCEPT,enabled:!0,firewallRuleApplied:Object(R.getRulePriority)({rule_index:2e3,...a})===R.FirewallRulePriority.HIGH?l.BEFORE:l.AFTER,dst_address:"",dst_firewallgroup_ids:[],dst_networkconf_type:R.FirewallRuleNetworkconfType.NETV4,icmp_typename:"",icmpv6_typename:"",ipsec:R.FirewallRuleIpsec.DONT_MATCH,logging:!1,name:"",protocol:"all",protocol_match_excepted:!1,protocol_v6:"all",ruleset:R.FirewallRuleRulesetV4.WAN_IN,src_firewallgroup_ids:[],src_address:"",src_mac_address:"",src_networkconf_type:R.FirewallRuleNetworkconfType.NETV4,state_established:!1,state_invalid:!1,state_new:!1,state_related:!1,...a,..._,...n}},w=[R.FirewallRuleAction.ACCEPT,R.FirewallRuleAction.REJECT,R.FirewallRuleAction.DROP].map(e=>({label:Object(O.c)(e),value:e})),f=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_VALUE_FIREWALL_RULE_APPLIED_BEFORE",value:l.BEFORE},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_VALUE_FIREWALL_RULE_APPLIED_AFTER",value:l.AFTER}],D=R.FIREWALL_RULE_ICMP_TYPENAMES.map(e=>({label:Object(O.d)(e),value:e})),g=R.FIREWALL_RULE_ICMPV6_TYPENAMES.map(e=>({label:Object(O.d)(e),value:e})),U=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_IPSEC_DONT_MATCH",value:R.FirewallRuleIpsec.DONT_MATCH},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_IPSEC_MATCH_IPSEC",value:R.FirewallRuleIpsec.MATCH_IPSEC},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_IPSEC_MATCH_NON_IPSEC",value:R.FirewallRuleIpsec.MATCH_NON_IPSEC}],h=[...R.FIREWALL_RULE_PROTOCOLS,"number"].map(e=>({label:Object(O.e)(e),value:e})),P=[...R.FIREWALL_RULE_PROTOCOLS_V6,"number"].map(e=>({label:Object(O.e)(e),value:e})),C=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_NETWORKCONF_TYPE_NETV4",value:R.FirewallRuleNetworkconfType.NETV4},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_NETWORKCONF_TYPE_ADDRV4",value:R.FirewallRuleNetworkconfType.ADDRV4}],W=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_TYPE_ADDRESS_PORT_GROUP",value:r.ADDRESS_PORT_GROUP},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_TYPE_NETWORK",value:r.NETWORK},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_TYPE_IP_ADDRESS",value:r.IP_ADDRESS}],y=[R.FirewallRuleRulesetV4.WAN_IN,R.FirewallRuleRulesetV4.WAN_OUT,R.FirewallRuleRulesetV4.WAN_LOCAL,R.FirewallRuleRulesetV4.LAN_IN,R.FirewallRuleRulesetV4.LAN_OUT,R.FirewallRuleRulesetV4.LAN_LOCAL,R.FirewallRuleRulesetV4.GUEST_IN,R.FirewallRuleRulesetV4.GUEST_OUT,R.FirewallRuleRulesetV4.GUEST_LOCAL,R.FirewallRuleRulesetV6.WANV6_IN,R.FirewallRuleRulesetV6.WANV6_OUT,R.FirewallRuleRulesetV6.WANV6_LOCAL,R.FirewallRuleRulesetV6.LANV6_IN,R.FirewallRuleRulesetV6.LANV6_OUT,R.FirewallRuleRulesetV6.LANV6_LOCAL,R.FirewallRuleRulesetV6.GUESTV6_IN,R.FirewallRuleRulesetV6.GUESTV6_OUT,R.FirewallRuleRulesetV6.GUESTV6_LOCAL].map(e=>({label:Object(O.f)(e),value:e})),v=I.a.object().shape({dst_address:I.a.string().when(["firewallRuleDstType","ruleset"],{is:(e,t)=>e===r.IP_ADDRESS&&!M({ruleset:t}),then:I.b}),dst_port:I.a.string().when(["firewallRuleDstType","protocol","ruleset"],{is:(e,t,a)=>e===r.IP_ADDRESS&&["tcp","tcp_udp","udp"].includes(t)&&!M({ruleset:a}),then:I.a.string().unifiPortRange(_.a.createElement(n.c,{id:"COMMON_VALIDATION_VALID_PORT_RANGE"}))}),firewallRuleDstType:I.a.string().oneOf(Object.values(r)),firewallRuleProtocolNumber:I.a.number().when(["protocol","protocol_v6","ruleset"],{is:(e,t,a)=>M({ruleset:a})?"number"===t:"number"===e,then:I.a.number().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_PROTOCOL_NUMBER_LABEL").required().min(0).max(255)}),name:I.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_NAME_LABEL").required(),firewallRuleSrcType:I.a.string().oneOf(Object.values(r)),protocol:I.a.string().oneOf(R.FIREWALL_RULE_PROTOCOLS),protocol_v6:I.a.string().oneOf(R.FIREWALL_RULE_PROTOCOLS_V6),ruleset:I.a.string().oneOf([...Object.values(R.FirewallRuleRulesetV4),...Object.values(R.FirewallRuleRulesetV6)]),src_address:I.a.string().when(["firewallRuleSrcType","ruleset"],{is:(e,t)=>e===r.IP_ADDRESS&&!M({ruleset:t}),then:I.b}),src_mac_address:I.a.string().matches(L.p,_.a.createElement(n.c,{id:"COMMON_VALIDATION_VALID_MAC"})),src_port:I.a.string().when(["firewallRuleSrcType","protocol","ruleset"],{is:(e,t,a)=>e===r.IP_ADDRESS&&["tcp","tcp_udp","udp"].includes(t)&&!M({ruleset:a}),then:I.a.string().unifiPortRange(_.a.createElement(n.c,{id:"COMMON_VALIDATION_VALID_PORT_RANGE"}))})});var V=a(1818),x=a(3),H=a(6),j=a(44),k=a(1739),B=a(1736),$=a(1914),Y=a(1737),z=a(1947),K=a(62);var X=()=>{const{setFieldValue:e,values:t}=Object(j.e)(),a=Object(E.useRef)(!0),l=M(t)?"all"===t.protocol_v6:"all"===t.protocol,r=M(t)?"icmpv6"===t.protocol_v6:"icmp"===t.protocol,c=M(t)?"number"===t.protocol_v6:"number"===t.protocol;return Object(E.useEffect)(()=>{if(!a.current)if(M(t)){const a=t.protocol,l=P.findIndex(({value:e})=>e===a);e("protocol_v6",P[-1!==l?l:0].value)}else{const a=t.protocol_v6,l=h.findIndex(({value:e})=>e===a);e("protocol",h[-1!==l?l:0].value)}a.current=!1},[t.ruleset]),_.a.createElement(k.a,null,_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:"ruleset",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_RULESET_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:"ruleset",options:y,searchable:!0,translateOptions:!0,type:"dropdown"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"input",htmlFor:"name",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_NAME_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:"name",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_NAME_PLACEHOLDER"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"enabled",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ENABLED_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{name:"enabled",type:"checkbox"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:"firewallRuleApplied",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_APPLIED_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:"firewallRuleApplied",options:f,translateOptions:!0,type:"dropdown"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:"action",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ACTION_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:"action",options:w,translateOptions:!0,type:"dropdown"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:M(t)?"protocol_v6":"protocol",label:_.a.createElement(n.c,{id:M(t)?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_PROTOCOL_V6_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_PROTOCOL_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:M(t)?"protocol_v6":"protocol",options:M(t)?P:h,searchable:!0,translateOptions:!0,type:"dropdown"}))),_.a.createElement(z.a,{in:r&&!t.protocol_match_excepted},_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:M(t)?"icmpv6_typename":"icmp_typename",label:_.a.createElement(n.c,{id:M(t)?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ICMPV6_TYPENAME_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ICMP_TYPENAME_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:M(t)?"icmpv6_typename":"icmp_typename",options:M(t)?g:D,searchable:!0,translateOptions:!0,type:"dropdown"})))),_.a.createElement(z.a,{in:c},_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"input",htmlFor:"firewallRuleProtocolNumber",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_PROTOCOL_NUMBER_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:"firewallRuleProtocolNumber",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_PROTOCOL_NUMBER_PLACEHOLDER",type:"number"})))),_.a.createElement(z.a,{in:!l},_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"protocol_match_excepted",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_PROTOCOL_MATCH_EXCEPTED_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{name:"protocol_match_excepted",type:"checkbox"})))))},q=a(5),J=a(244),Q=a(1741),Z=a(520),ee=a(2471),te=a(2132);const ae=Object(q.c)(Q.a)`
  width: 378px !important;
`,le=Object(q.c)("div")`
  padding: ${({theme:e})=>e.spacing["spacing-s"]} 0;
`;var re=({hideModal:e,handleGroupField:t,type:a,initialValues:l={}})=>{const r=Object(c.useDispatch)(),o=Object(c.useSelector)(u.x),i=Object(E.useCallback)((a,{setSubmitting:l})=>r(Object(T.saveFirewallGroup)({...a,group_members:(a.group_members||[]).filter(e=>!!e)})).then(e=>{t(e),r(Object(p.c)({icon:d.a.success,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_TOAST_SAVE_SUCCESS",values:{name:a.name}}))}).then(e).catch(e=>{r(Object(p.c)({errorMessage:e.msg,errorValues:e,icon:d.a.danger,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_TOAST_SAVE_FAILURE",values:{name:a.name}})),l(!1)}),[r,e,t]);return _.a.createElement(j.c,{onSubmit:i,initialValues:{name:"",group_type:a,group_members:[],...l},validationSchema:te.b},({handleSubmit:t,isSubmitting:a})=>_.a.createElement(ae,{parentSelector:Z.b,isOpen:!0,title:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_TITLE_NEW"}),actions:[{text:_.a.createElement(n.c,{id:"COMMON_ACTION_CANCEL"}),type:"button",style:{width:123},onClick:e},{text:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_BUTTON_CREATE"}),type:"submit",variant:"primary",style:{width:175},disabled:o||a,loader:a?"spinner":null,onClick:()=>t()}]},_.a.createElement(le,null,_.a.createElement(ee.a,{modalForm:!0}))))};const Ee=Object(q.c)("li",{shouldForwardProp:e=>"isNewGroupItem"!==e})`
  ${({theme:e,isNewGroupItem:t})=>t&&`\n    color: ${e.motifPalette.link01};\n    :hover {\n      color: ${e.motifPalette.hoverLink01};\n    }\n  `}
`,_e=(e,t)=>{const a=parseInt(t,10);return!(t!==a.toString()||!Number.isFinite(a))&&(2===e.length&&a>=parseInt(e[0],10)&&a<=parseInt(e[1],10))};function ne({id:e,onClick:t,isSelected:a,className:l,children:r,option:E}){const c=J.a===E.value;return _.a.createElement(Ee,{id:e,onClick:t,className:l,"aria-selected":a,role:"option",isNewGroupItem:c},c?_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_BUTTON_CREATE"}):r||E.label)}var ce=({name:e,options:t,type:a})=>{const{setFieldValue:l}=Object(j.e)(),[r,n]=Object(E.useState)(!1),[c,o]=Object(E.useState)(""),i=Object(E.useCallback)((t,a)=>{J.a===a?n(!0):l(e,a)},[e,l]),R=Object(E.useCallback)((e,t)=>e.filter(({label:e,members:l=[]})=>e.toString().toLowerCase().includes(t.toLowerCase())||((e,t,a)=>e.some(e=>{if(e===t)return!0;switch(a){case T.FirewallGroupType.PORT_GROUP:return _e(e.split("-"),t);case T.FirewallGroupType.ADDRESS_GROUP:return _e(e.split("-").map(e=>e.replace(/\./g,"")),t.replace(/\./g,""));default:return!1}}))(l,t,a)),[a]),s=Object(E.useMemo)(()=>{let e=[L.r];return a===T.FirewallGroupType.ADDRESS_GROUP&&(e=[L.h,L.j]),a===T.FirewallGroupType.IPV6_ADDRESS_GROUP&&(e=[L.k,L.m]),e.some(e=>c.match(e))?{group_members:[c]}:{name:c}},[c,a]);return _.a.createElement(_.a.Fragment,null,_.a.createElement(K.Field,{name:e,options:t,renderOption:ne,onChange:i,inputProps:{onBlur:e=>o(e.target.value)},customSearchFilter:R,type:"dropdown",searchable:!0,creatable:!0,full:!0}),r&&_.a.createElement(re,{hideModal:()=>n(!1),handleGroupField:({_id:t,group_type:r})=>{r===a&&l(e,t)},type:a,initialValues:s}))};var oe=Object(n.f)(({intl:e,src:t})=>{const a=t?"src_address":"dst_address",l=t?"firewallRuleSrcIpV4AddressGroup":"firewallRuleDstIpV4AddressGroup",o=t?"firewallRuleSrcIpV6AddressGroup":"firewallRuleDstIpV6AddressGroup",i=t?"src_networkconf_id":"dst_networkconf_id",R=t?"src_networkconf_type":"dst_networkconf_type",u=t?"firewallRuleSrcPortGroup":"firewallRuleDstPortGroup",A=t?"src_port":"dst_port",N=t?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_FIREWALL_RULE_SRC_TYPE_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_FIREWALL_RULE_DST_TYPE_LABEL",m=t?"firewallRuleSrcType":"firewallRuleDstType",{errors:p,values:S}=Object(j.e)(),d=Object(c.useSelector)(s.selectCorporateAndGuestNetworks),L=Object(c.useSelector)(T.selectFirewallGroups),I=Object(E.useMemo)(()=>F(L,T.FirewallGroupType.ADDRESS_GROUP,e),[L,e]),O=Object(E.useMemo)(()=>F(L,T.FirewallGroupType.IPV6_ADDRESS_GROUP,e),[L,e]),G=Object(E.useMemo)(()=>d.map(({_id:e,name:t})=>({label:t,value:e})),[d]),b=Object(E.useMemo)(()=>F(L,T.FirewallGroupType.PORT_GROUP,e),[L,e]);return _.a.createElement(k.a,{padding:"none"},M(S)?_.a.createElement(_.a.Fragment,null,_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:o,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_IPV6_ADDRESS_GROUP_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(ce,{name:o,options:O,type:T.FirewallGroupType.IPV6_ADDRESS_GROUP}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:u,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_GROUP_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(ce,{name:u,options:b,type:T.FirewallGroupType.PORT_GROUP})))):_.a.createElement(_.a.Fragment,null,_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:m,label:_.a.createElement(n.c,{id:N})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{full:!0,name:m,options:W,translateOptions:!0,type:"dropdown"}))),_.a.createElement(z.a,{in:S[m]===r.ADDRESS_PORT_GROUP,wrap:!0,flexDirection:"column"},S[m]===r.ADDRESS_PORT_GROUP&&_.a.createElement(_.a.Fragment,null,_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:l,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_IPV4_ADDRESS_GROUP_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(ce,{name:l,options:I,type:T.FirewallGroupType.ADDRESS_GROUP}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:u,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_GROUP_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(ce,{name:u,options:b,type:T.FirewallGroupType.PORT_GROUP}))))),_.a.createElement(z.a,{in:S[m]===r.NETWORK,wrap:!0,flexDirection:"column"},S[m]===r.NETWORK&&_.a.createElement(_.a.Fragment,null,_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:i,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_NETWORKCONF_ID"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{full:!0,name:i,options:G,type:"dropdown"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"dropdown",htmlFor:R,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_NETWORKCONF_TYPE"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{full:!0,name:R,options:C,translateOptions:!0,type:"dropdown"}))))),_.a.createElement(z.a,{in:S[m]===r.IP_ADDRESS,wrap:!0,flexDirection:"column"},S[m]===r.IP_ADDRESS&&_.a.createElement(_.a.Fragment,null,_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"input",htmlFor:a,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_ADDRESS_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:a,placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_ADDRESS_PLACEHOLDER"}))),["tcp","tcp_udp","udp"].includes(S.protocol)&&_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"input",htmlFor:A,label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:A,placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_PLACEHOLDER"})))))),t&&_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"input",htmlFor:"src_mac_address",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_SRC_MAC_ADDRESS_LABEL"})}),_.a.createElement(Y.a,{column:!0},_.a.createElement(K.Field,{full:!0,name:"src_mac_address",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_SRC_MAC_ADDRESS_PLACEHOLDER"}))))});var ie=()=>_.a.createElement(k.a,{padding:"none"},_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"logging",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_LOGGING_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{name:"logging",type:"checkbox"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_new",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_NEW_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{name:"state_new",type:"checkbox"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_established",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_ESTABLISHED_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{name:"state_established",type:"checkbox"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_invalid",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_INVALID_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{name:"state_invalid",type:"checkbox"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_related",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_RELATED_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{name:"state_related",type:"checkbox"}))),_.a.createElement(B.a,null,_.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"ipsec",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_IPSEC_LABEL"})}),_.a.createElement(Y.a,null,_.a.createElement(K.Field,{full:!0,name:"ipsec",options:U,translateOptions:!0,type:"dropdown"}))));var Te=()=>{const e=Object(E.useMemo)(()=>[{id:"firewall-rule-source",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ACCORDION_SOURCE_LABEL"}),renderContent:()=>_.a.createElement(oe,{src:!0})},{id:"firewall-rule-destination",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ACCORDION_DESTINATION_LABEL"}),renderContent:()=>_.a.createElement(oe,{dst:!0})},{id:"firewall-rule-advanced",label:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ACCORDION_ADVANCED_LABEL"}),renderContent:()=>_.a.createElement(ie,null)}],[]);return Object(S.f)([Object(T.fetchFirewallGroups)(void 0,{crudCacheStrategy:{type:H.a.CACHE}}),Object(R.fetchFirewallRules)(void 0,{crudCacheStrategy:{type:H.a.CACHE}}),Object(s.fetchNetworks)(void 0,{crudCacheStrategy:{type:H.a.CACHE}}),Object(x.fetchSiteGateway)()],_.a.createElement(_.a.Fragment,null,_.a.createElement(X,null),_.a.createElement(V.a,{items:e,multiOpen:!0})))};t.default=()=>{const e=Object(S.h)({openFirewall:!0}),{ruleId:t}=Object(o.m)(),a=Object(c.useDispatch)(),L=Object(c.useSelector)(R.selectAllFirewallRules),I=Object(c.useSelector)(s.selectCorporateAndGuestNetworks),O=Object(c.useSelector)(T.selectFirewallGroups),F=Object(c.useSelector)(R.selectFirewallRule)(t),G=Object(c.useSelector)(u.x),w=Object(c.useSelector)(A.m),f=Object(E.useMemo)(()=>b(I,O,F),[I,O,F]),D=Object(S.n)({component:_.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_TITLE_NEW"}),message:"firewall-rule"},"firewall-rule",(null==F?void 0:F._id)?null==F?void 0:F.name:void 0),g=Object(E.useCallback)((t,{setSubmitting:E})=>a(Object(R.saveFirewallRule)(((e,t,a,E)=>{const _=b([],[]),{firewallRuleApplied:n,firewallRuleDstIpV4AddressGroup:c,firewallRuleDstIpV6AddressGroup:o,firewallRuleDstPortGroup:i,firewallRuleDstType:T,firewallRuleProtocolNumber:s,firewallRuleSrcIpV4AddressGroup:u,firewallRuleSrcIpV6AddressGroup:A,firewallRuleSrcPortGroup:N,firewallRuleSrcType:m,...p}=e;p.dst_firewallgroup_ids=T===r.ADDRESS_PORT_GROUP?[].concat((M(e)?o:c)||[]).concat(i||[]):_.dst_firewallgroup_ids,p.src_firewallgroup_ids=m===r.ADDRESS_PORT_GROUP?[].concat((M(e)?A:u)||[]).concat(N||[]):_.src_firewallgroup_ids,M(e)?(delete p.dst_address,delete p.dst_networkconf_id,delete p.dst_networkconf_type,delete p.dst_port,delete p.icmp_typename,delete p.protocol,delete p.src_address,delete p.src_networkconf_id,delete p.src_networkconf_type,delete p.src_port,p.icmpv6_typename="icmpv6"!==e.protocol_v6||e.protocol_match_excepted?_.icmpv6_typename:e.icmpv6_typename,p.protocol_match_excepted="all"===e.protocol_v6?_.protocol_match_excepted:e.protocol_match_excepted,p.protocol_v6="number"===e.protocol_v6?Number(e.firewallRuleProtocolNumber):e.protocol_v6):(delete p.icmpv6_typename,delete p.protocol_v6,p.dst_address=T===r.IP_ADDRESS?e.dst_address:_.dst_address,p.dst_networkconf_id=T===r.NETWORK?e.dst_networkconf_id:_.dst_networkconf_id,p.dst_networkconf_type=T===r.NETWORK?e.dst_networkconf_type:_.dst_networkconf_type,p.dst_port=T===r.IP_ADDRESS?e.dst_port:_.dst_port,p.icmp_typename="icmp"!==e.protocol||e.protocol_match_excepted?_.icmp_typename:e.icmp_typename,p.protocol="number"===e.protocol?Number(e.firewallRuleProtocolNumber):e.protocol,p.protocol_match_excepted="all"===e.protocol?_.protocol_match_excepted:e.protocol_match_excepted,p.src_address=m===r.IP_ADDRESS?e.src_address:_.src_address,p.src_networkconf_id=m===r.NETWORK?e.src_networkconf_id:_.src_networkconf_id,p.src_networkconf_type=m===r.NETWORK?e.src_networkconf_type:_.src_networkconf_type,p.src_port=m===r.IP_ADDRESS&&["tcp","tcp_udp","udp"].includes(e.protocol)?e.src_port:_.src_port);const S=n===l.BEFORE?R.FirewallRulePriority.HIGH:R.FirewallRulePriority.LOW;let d=e.rule_index;if(!e._id||e.ruleset!==t.ruleset||Object(R.getRulePriority)(e)!==S){const t=a?"udm":"ugw",l=M(e)?"v6":"v4",[r,_]=R.FIREWALL_RULE_INDEX_SCOPE[t][l][S],n=E.filter(({rule_index:t,ruleset:a})=>a===e.ruleset&&Number(t)>=r&&Number(t)<=_).pop()||{rule_index:r-1};d=Number(n.rule_index)+1,d=String(Math.min(d,_))}return p.rule_index=d,p})(t,f,w,L))).then(()=>{a(Object(p.c)({icon:d.a.success,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_TOAST_SAVE_SUCCESS",values:{name:t.name}})),e()}).catch(e=>{a(Object(p.c)({errorMessage:e.msg,errorValues:e,icon:d.a.danger,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_TOAST_SAVE_FAILURE",values:{name:t.name}})),E(!1)}),[L,a,f,w,e]),U=Object(E.useCallback)(()=>a(Object(m.b)({name:f.name,onConfirm:()=>a(Object(R.removeFirewallRule)({id:f._id,name:f.name})).then(()=>{e()})})),[a,f,e]);return _.a.createElement(N.b,{goBack:e,initialValues:f,isView:G,showBack:!0,title:D,validationSchema:v,onEscClicked:e,onSubmit:g,footerActiveOverride:!!(null==f?void 0:f._id),customFooterButtons:e=>(null==f?void 0:f._id)&&_.a.createElement(i.a,{disabled:e,type:"button",variant:"default",onClick:U},_.a.createElement(n.c,{id:"COMMON_ACTION_REMOVE"}))},_.a.createElement(Te,null))}},1929:function(e,t,a){"use strict";var l=a(0),r=a.n(l),E=a(5),_=a(2),n=a(1946),c=a.n(n),o=a(1741),i=a(520),T=a(521);const R=Object(E.c)("span")`
  line-height: 1.5;
  margin-top: ${({theme:e})=>e.spacing["spacing-xxxxl"]};
`;t.a=({when:e,ignoredPaths:t=null,onLeave:a=null,onStay:E=null})=>{const n=Object(l.useMemo)(()=>({overlay:{"--modal-z-index":2e3}}),[]),s=Object(T.a)(t),u=Object(l.useCallback)((e,t)=>t.pathname!==e.pathname,[]),A=Object(l.useCallback)(e=>(e={},t={})=>s(e,t)&&u(e,t),[s,u]);return!!e&&r.a.createElement(c.a,{when:A(t)},({onCancel:e,onConfirm:t})=>r.a.createElement(o.a,{actions:[{type:"button",text:r.a.createElement(_.c,{id:"SETTINGS_MODAL_UNSAVED_CHANGES_STAY"}),onClick:()=>E?E(e):e()},{type:"button",text:r.a.createElement(_.c,{id:"SETTINGS_MODAL_UNSAVED_CHANGES_LEAVE"}),onClick:()=>a?a(t):t(),variant:"primary"}],isOpen:!0,size:"small",style:n,parentSelector:i.b,title:r.a.createElement(_.c,{id:"SETTINGS_MODAL_UNSAVED_CHANGES_TITLE"}),onRequestClose:()=>E?E(e):e()},r.a.createElement(R,null,r.a.createElement(_.c,{id:"SETTINGS_MODAL_UNSAVED_CHANGES_CONTENT"}))))}},1930:function(e,t,a){"use strict";var l=a(0),r=a(36);t.a=()=>{const e=Object(r.l)(),[t]=Object(l.useState)(e.pathname),[a,E]=Object(l.useState)(!1),_=Object(l.useRef)();return Object(l.useEffect)(()=>{E(!1);const a=/^(.*)\/[a-z0-9]*/i.exec(t),l=/^(.*)\/[a-z0-9]*/i.exec(e.pathname);return a[0].length===l[0].length&&a[1]===l[1]&&(_.current=setTimeout(()=>E(!0),500)),()=>clearTimeout(_.current)},[e.pathname,t]),a}},1938:function(e,t,a){"use strict";a.d(t,"b",(function(){return W})),a.d(t,"a",(function(){return f}));var l=a(0),r=a.n(l),E=a(5),_=a(2),n=a(44),c=a(2847),o=a(2658),i=a(1929),T=a(783),R=a(71),s=a(1940),u=a(15),A=a(32),N=a(42),m=a(1847),p=a(782),S=a(1930);const d=E.a`
  &-appear,
  &-enter {
    opacity: 0;
    transform: translateX(15px);
  }
  &-appear-active,
  &-enter-active,
  &-appear-done,
  &-enter-done {
    opacity: 1;
    transform: translateX(0);
    transition: opacity 150ms cubic-bezier(0.25, 0.1, 0.25, 1) 130ms,
      transform 300ms cubic-bezier(0.25, 0.1, 0.25, 1.4) 130ms;
  }
  &-exit {
    opacity: 1;
    transform: translateX(0);
  }
  &-exit-active,
  &-exit-done {
    opacity: 0;
    transform: translateX(15px);
    transition: opacity 100ms linear, transform 100ms linear;
  }
`;var L=({timeout:e={enter:300,exit:100},in:t,children:a,ignoredPaths:E,..._})=>{const n=Object(S.a)(),c=Object(p.a)(E),o=Object(l.useMemo)(()=>r.a.Children.map(a,a=>null===a?a:r.a.createElement(m.a,Object.assign({appear:t||!c||n,in:t||!c||n,timeout:e,classNames:d,mountOnEnter:!0},_),a)),[a,t,c,n,e,_]);return r.a.createElement(r.a.Fragment,null,o)};const I=E.a`
  &-appear,
  &-enter {
    border-bottom: transparent !important;
  }
  &-appear-active,
  &-enter-active,
  &-appear-done,
  &-enter-done {
    transition: border-bottom 150ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-exit {
    opacity: 1;
  }
  &-exit-active,
  &-exit-done {
    opacity: 0;
    transition: opacity 100ms linear;
  }
`;var O=({timeout:e={enter:150,exit:100},in:t,children:a,ignoredPaths:E,..._})=>{const n=Object(S.a)(),c=Object(p.a)(E),o=Object(l.useMemo)(()=>r.a.Children.map(a,a=>null===a?a:r.a.createElement(m.a,Object.assign({appear:t||!c||n,in:t||!c||n,timeout:e,classNames:I,mountOnEnter:!0},_),a)),[a,t,c,n,e,_]);return r.a.createElement(r.a.Fragment,null,o)};const F=Object(E.c)(R.g)`
  > * {
    /* Use margin on child rather than padding on self not to occupy space when no button is shown */
    margin-left: ${({theme:e})=>e.spacing["spacing-xxl"]};
    margin-right: ${({theme:e})=>e.spacing["spacing-xxl"]};
  }
`,G=Object(E.c)(R.g)`
  border-bottom: 1px solid ${({theme:e})=>e.motifPalette.ui03};
`,M=Object(E.c)("h1")`
  font-size: 16px;
  font-weight: normal;
`,b=Object(E.c)(R.c)`
  padding: ${({theme:e})=>e.spacing["spacing-s"]};
`,w=Object(E.c)(A.a)`
  color: ${({theme:e})=>e.motifPalette.text01} !important;
  font-size: 16px !important;
`;var f=({title:e,showBack:t,goBack:a,onEscClicked:l,hideClose:E,ignoredPaths:_})=>{const{motif:n}=Object(N.a)();return r.a.createElement(O,{ignoredPaths:_},r.a.createElement(G,{flex:"none",height:"65px"},r.a.createElement(L,{ignoredPaths:_},r.a.createElement(R.g,{alignItems:"center",flex:"1",justifyContent:"space-between"},r.a.createElement(F,{alignItems:"center",flex:"1",height:"100%"},t&&r.a.createElement(b,{legacy:!1,name:"backButton",type:"button",onClick:a,motif:n},r.a.createElement(u.f,{size:"original"}))),r.a.createElement(M,null,r.a.createElement(w,{weight:"bold"},e.component)),r.a.createElement(F,{alignItems:"center",flex:"1",height:"100%",justifyContent:"flex-end"},!E&&r.a.createElement(b,{legacy:!1,name:"closeButton",type:"button",onClick:l},r.a.createElement(u.y,{size:"original"})))))))};const D=Object(E.c)(R.g)`
  width: 100%;
  max-width: ${T.a};
  margin: 0 auto;
  padding: ${({theme:e})=>e.spacing["spacing-xxxxl"]}
    ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px;
`,g=Object(E.c)("form")`
  display: flex;
  flex: 1;
  overflow: hidden;
  width: 100%;
  height: 100%;
`,U=Object(E.c)(R.g)`
  @media (max-width: 1010px) {
    flex-direction: column;
  }
`,h=Object(E.c)(c.a)`
  transition: height 100ms ease, transform 100ms ease; /* TODO: Remove with next ui-components update (v25.1.1 +)  */
  > :first-child {
    max-width: ${T.a};
    padding-left: ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px !important;
    padding-right: ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px !important;
    position: relative;
    margin: 0 auto;
  }
`,P=Object(E.c)(R.h)`
  background: transparent;
  overflow: scroll !important;
  margin-right: -${({theme:e})=>e.scrollBarWidth}px;
`,C=Object(E.c)(R.k)`
  height: 100%;
  width: 100%;
`;var W=({children:e,disableUnsavedChangesModal:t,goBack:a,hideClose:l,isEdit:E,isView:c,showBack:T,title:u,unsavedChangesModalIgnoredPaths:A,onEscClicked:N,submitText:m="COMMON_ACTION_APPLY_CHANGES",footerActiveOverride:p=!1,customFooterButtons:S,hidddenHeader:d,...L})=>r.a.createElement(n.c,Object.assign({enableReinitialize:!0},L),({dirty:E,handleReset:n,handleSubmit:L,isSubmitting:I})=>r.a.createElement(g,{autoComplete:"off",onSubmit:L},r.a.createElement(C,{vertical:!0},!d&&r.a.createElement(f,{goBack:a,hideClose:l,showBack:T,title:u,onEscClicked:N,ignoredPaths:A}),r.a.createElement(s.a,{ignoredPaths:A},r.a.createElement(P,{flex:"1"},r.a.createElement(D,{flex:"none",flexDirection:"column"},e))),!t&&!c&&r.a.createElement(i.a,{ignoredPaths:A,when:E&&!I}),(!c||p)&&r.a.createElement(h,{active:E||p},r.a.createElement(R.g,{justifyContent:S?"space-between":"flex-end",width:"100%",alignItems:"center"},S&&r.a.createElement(U,null,S(I)),!c&&r.a.createElement(R.g,null,r.a.createElement(o.a,{disabled:!E||I,type:"button",variant:"default",onClick:n},r.a.createElement(_.c,{id:"COMMON_ACTION_CANCEL"})),r.a.createElement(o.a,{disabled:!E||I,type:"submit",variant:"primary"},r.a.createElement(_.c,{id:m}))))))))},1940:function(e,t,a){"use strict";var l=a(0),r=a.n(l),E=a(1847),_=a(5),n=a(782),c=a(1930);const o=_.a`
  &-appear,
  &-enter {
    opacity: 0;
    transform: translateX(60px);
  }
  &-appear-active,
  &-enter-active {
    opacity: 1;
    transform: translateX(0);
    transition: opacity 150ms cubic-bezier(0.25, 0.1, 0.25, 1), transform 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-exit {
    opacity: 1;
    transform: translateX(0);
  }
  &-exit-active,
  &-exit-done {
    opacity: 0;
    transform: translateX(60px);
    transition: opacity 100ms cubic-bezier(0.25, 0.1, 0.25, 1), transform 100ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
`;t.a=({timeout:e={enter:300,exit:100},in:t,ignoredPaths:a,children:_,...i})=>{const T=Object(c.a)(),R=Object(n.a)(a),s=Object(l.useMemo)(()=>r.a.Children.map(_,a=>null===a?a:r.a.createElement(E.a,Object.assign({appear:t||!R||T,in:t||!R||T,timeout:e,classNames:o,mountOnEnter:!0},i),a)),[_,t,R,T,e,i]);return r.a.createElement(r.a.Fragment,null,s)}},1947:function(e,t,a){"use strict";var l=a(0),r=a.n(l),E=a(1847),_=a(5);const n=(e,t)=>_.a`
  &-appear,
  &-enter {
    opacity: 0;
    display: flex !important;
    transform: translateY(-10px);
  }
  &-appear-active,
  &-enter-active {
    display: flex !important;
    ${e&&`flex-direction: ${e};`}
    ${t&&`padding: ${t};`}
    opacity: 1;
    transform: translateY(0px);
    transition: opacity 150ms ease-in-out, transform 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-appear-done,
  &-enter-done {
    display: flex !important;
    ${e&&`flex-direction: ${e};`}
    ${t&&`padding: ${t};`}
    opacity: 1;
  }
  &-exit {
    display: flex !important;
    opacity: 0;
    height: 0;
    box-sizing: border-box;
    margin: 10px 0 0 !important;
    & > * {
      display: none;
    }
  }
  &-exit-active {
    display: flex !important;
    margin: 0 !important;
    transition: margin 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-exit-done {
    display: none;
  }
`;t.a=r.a.memo(({timeout:e=300,in:t=!1,flexDirection:a,padding:_="0 0 32px",wrap:c=!1,children:o,...i})=>{const T=Object(l.useMemo)(()=>r.a.Children.map(o,(l,_)=>r.a.createElement(E.a,Object.assign({appear:t,in:t,timeout:e,classNames:n(a,void 0),mountOnEnter:!0},i),null===l?r.a.createElement("div",null):l)),[o,a,t,i,e]);return c?r.a.createElement(E.a,Object.assign({appear:t,in:t,timeout:e,classNames:n(a,_),mountOnEnter:!0},i),r.a.createElement("div",null,o)):r.a.createElement(r.a.Fragment,null,T)})},1972:function(e,t,a){"use strict";a.r(t),a.d(t,"fetchFirewallGroups",(function(){return n})),a.d(t,"saveFirewallGroup",(function(){return c})),a.d(t,"removeFirewallGroup",(function(){return o})),a.d(t,"MODEL",(function(){return E})),a.d(t,"PATH",(function(){return _})),a.d(t,"firewallGroupsSelector",(function(){return s})),a.d(t,"selectFirewallGroups",(function(){return u})),a.d(t,"selectFirewallGroup",(function(){return A})),a.d(t,"FirewallGroupType",(function(){return N}));var l=a(28),r=a(6);const E="firewallgroup",_="/api/s/{site}/rest/"+E,n=(e,t)=>Object(r.q)(E,_,e,{...t,idField:"_id"}),c=e=>e._id?Object(r.C)(E,e._id,`${_}/${e._id}`,e):Object(r.i)(E,_,e),o=({id:e,name:t})=>Object(r.n)(E,e,`${_}/${e}`,{},Object(l.a)("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TOAST_REMOVE_FAILURE","SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TOAST_REMOVE_SUCCESS",{name:t}));var i=a(20),T=a(63),R=a(4);const s=Object(r.A)(n()),u=Object(R.a)(s,e=>Object(i.a)(e,"data",[])),A=Object(R.a)(u,e=>Object(T.a)(t=>e.find(({_id:e})=>e===t)));var N;!function(e){e.PORT_GROUP="port-group",e.ADDRESS_GROUP="address-group",e.IPV6_ADDRESS_GROUP="ipv6-address-group"}(N||(N={}))},2132:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return o}));var l=a(0),r=a.n(l),E=a(2),_=a(1972),n=a(30);const c=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_PORT_GROUP",value:_.FirewallGroupType.PORT_GROUP},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_ADDRESS_GROUP",value:_.FirewallGroupType.ADDRESS_GROUP},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_IPV6_ADDRESS_GROUP",value:_.FirewallGroupType.IPV6_ADDRESS_GROUP}],o=n.a.object({name:n.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_NAME_LABEL").required(),group_type:n.a.string(),group_members:n.a.array().when("group_type",{is:_.FirewallGroupType.PORT_GROUP,then:n.a.array().of(n.a.string().unifiPortRange(r.a.createElement(E.c,{id:"COMMON_VALIDATION_VALID_PORT"}),!0))}).when("group_type",{is:_.FirewallGroupType.ADDRESS_GROUP,then:n.a.array().of(n.a.string().unifiIpv4Range(r.a.createElement(E.c,{id:"COMMON_VALIDATION_VALID_IP_SUBNET_RANGE",values:{name:r.a.createElement(E.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_LABEL"})}})))}).when("group_type",{is:_.FirewallGroupType.IPV6_ADDRESS_GROUP,then:n.a.array().of(n.a.string().unifiIpv6Range(r.a.createElement(E.c,{id:"COMMON_VALIDATION_VALID_IPV6"})))})})},2163:function(e,t,a){"use strict";a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return T})),a.d(t,"d",(function(){return R})),a.d(t,"f",(function(){return s})),a.d(t,"g",(function(){return u}));var l=a(0),r=a.n(l),E=a(2),_=a(1972),n=a(524);const c=e=>"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_PROTOCOL_"+e.replace(/[.-]/g,"_").toUpperCase(),o=e=>{const t=void 0!==e.protocol&&null!==e.protocol?e.protocol:e.protocol_v6,a=!Number.isNaN(Number(t));return e.protocol_match_excepted?r.a.createElement(E.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_PROTOCOL_MATCH_EXCEPTED",values:{protocol:a?t:r.a.createElement(E.c,{id:c(t)})}}):a?String(t):r.a.createElement(E.c,{id:c(t)})},i=e=>{switch(e){case _.FirewallGroupType.ADDRESS_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_ADDRESS_GROUP";case _.FirewallGroupType.IPV6_ADDRESS_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_IPV6_ADDRESS_GROUP";case _.FirewallGroupType.PORT_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_PORT_GROUP";default:return"COMMON_UNKNOWN"}},T=e=>{switch(e){case n.FirewallRuleAction.ACCEPT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_ACCEPT";case n.FirewallRuleAction.DROP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_DROP";case n.FirewallRuleAction.REJECT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_REJECT";default:return"COMMON_UNKNOWN"}},R=e=>"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ICMP_TYPENAME_"+(e||"none").replace(/-/g,"_").toUpperCase(),s=e=>{switch(e){case n.FirewallRuleRulesetV4.GUEST_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_IN";case n.FirewallRuleRulesetV4.GUEST_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_LOCAL";case n.FirewallRuleRulesetV4.GUEST_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_OUT";case n.FirewallRuleRulesetV4.LAN_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_IN";case n.FirewallRuleRulesetV4.LAN_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_LOCAL";case n.FirewallRuleRulesetV4.LAN_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_OUT";case n.FirewallRuleRulesetV4.WAN_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_IN";case n.FirewallRuleRulesetV4.WAN_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_LOCAL";case n.FirewallRuleRulesetV4.WAN_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_OUT";case n.FirewallRuleRulesetV6.GUESTV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_IN";case n.FirewallRuleRulesetV6.GUESTV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_LOCAL";case n.FirewallRuleRulesetV6.GUESTV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_OUT";case n.FirewallRuleRulesetV6.LANV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_IN";case n.FirewallRuleRulesetV6.LANV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_LOCAL";case n.FirewallRuleRulesetV6.LANV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_OUT";case n.FirewallRuleRulesetV6.WANV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_IN";case n.FirewallRuleRulesetV6.WANV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_LOCAL";case n.FirewallRuleRulesetV6.WANV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_OUT";default:return"COMMON_UNKNOWN"}},u=e=>{let t=Math.min(...e.map(({rule_index:e})=>Number(e)));return e.map(e=>({...e,rule_index:(t++).toString()}))}},2471:function(e,t,a){"use strict";var l=a(0),r=a.n(l),E=a(5),_=a(2),n=a(44),c=a(1739),o=a(1736),i=a(1914),T=a(1737),R=a(1972),s=a(71),u=a(62),A=a(2132);const N=Object(E.c)("div")`
  flex: none;
  padding-top: ${({hasItems:e})=>e?0:"12px"};
  width: 100%;
`;t.a=({modalForm:e=!1})=>{const{setFieldValue:t,values:a}=Object(n.e)(),E=(Object(l.useContext)(s.l),Object(l.useCallback)(e=>t("group_members",e),[t]));return r.a.createElement(c.a,{padding:e?"none":void 0},r.a.createElement(o.a,null,!e&&r.a.createElement(i.a,{alignWith:"input",htmlFor:"name",label:r.a.createElement(_.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_NAME_LABEL"})}),r.a.createElement(T.a,{column:!0},r.a.createElement(u.Field,{full:!0,name:"name",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_NAME_LABEL"}))),r.a.createElement(o.a,null,!e&&r.a.createElement(i.a,{alignWith:"dropdown",htmlFor:"group_type",label:r.a.createElement(_.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_TYPE_LABEL"})}),r.a.createElement(T.a,{column:!0},r.a.createElement(u.Field,{full:!0,name:"group_type",options:A.a,translateOptions:!0,type:"dropdown"}))),r.a.createElement(o.a,null,!e&&r.a.createElement(i.a,{alignWith:"input",htmlFor:"group_members[0]",label:r.a.createElement(_.c,{id:a.group_type===R.FirewallGroupType.PORT_GROUP?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_PORT_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_LABEL"})}),r.a.createElement(T.a,{column:!0},r.a.createElement(N,{hasItems:a.group_members.length>0},r.a.createElement(u.NewMultiInput,{addButtonLabel:a.group_type===R.FirewallGroupType.PORT_GROUP?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_PORT_ADD":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_ADD",label:a.group_type===R.FirewallGroupType.PORT_GROUP?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_PORT_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_LABEL",max:1e3,name:"group_members",values:a.group_members,onChange:E})))))}}}]);